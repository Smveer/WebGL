<!DOCTYPE html>
<html lang="EN">
	<head>
		<title>Project WEBGL</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="../ressources/css/main.css">
	</head>
	<body>

		<script type="module">

            //IMPORT DES DÉPENDANCES
			import * as THREE from '../build/three.module.js';
            import {OrbitControls} from "./jsm/controls/OrbitControls.js";

            //DÉCLARATIONS DES OBJETS DE LA SCÈNE
            var camera, scene, renderer, controls, ambient, spotLight, lightHelper;

            //DÉCLARATION DE LA BASE
            var mesh_floor, ground, leftWall, rightWall, frontWall, backWall;

            //DÉCLARATION DES TOURELLES DE LA BASE
            var turretBackLeft, turretBackRight, turretFrontLeft, turretFrontRight;

            //DÉCLARATION DE L'ENTRÉE
            var frontGateBig, frontGateSmall, miniTurretFrontLeft, miniTurretFrontRight, miniTurretBackLeft, miniTurretBackRight;

            //DÉCLARATION DES MINI TOURELLES DE LA TOURELLE GAUCHE
            var miniTurretFrontLeft_frontLeft, miniTurretFrontRight_frontLeft, miniTurretBackLeft_frontLeft, miniTurretBackRight_frontLeft;

            //DÉCLARATION DES MINI TOURELLES DE LA TOURELLE DROITE
            var miniTurretFrontLeft_frontRight, miniTurretFrontRight_frontRight, miniTurretBackLeft_frontRight, miniTurretBackRight_frontRight;

            //DÉCLARATION DES BATÎMENTS
            var mainBuilding, mainBuildingFront, mainBuildingLittleFront, mainBuildingMiddle;

            //DÉCLARATION DES MINI TOURELLES DES BATÎMENTS
            var miniTurretMainBuilding_frontLeft, miniTurretMainBuilding_frontRight;

            //DÉCLARATION DES OBJETS DES MINARETS
            var minaret_Base, minaret_LowerCylinder, minaret_deco2Base, minaret_deco1Base, minaret_BaseLinkOcto, minaret_LowerBalconyBottom, minaret_LowerBalconyTop, minaret_MiddleCylinder, minaret_MiddleBalconyTop, minaret_MiddleBalconyBottom, minaret_HigherBalconyTop, minaret_HigherBalconyBottom, minaret_SpikeBottom, minaret_Spike, minaret_SpikeCircle1, minaret_SpikeCircle2, minaret_SpikeTop, minaret_Moon;
            var minaretFR_Base, minaretFR_LowerCylinder, minaretFR_deco2Base, minaretFR_deco1Base, minaretFR_BaseLinkOcto, minaretFR_LowerBalconyBottom, minaretFR_LowerBalconyTop, minaretFR_MiddleCylinder, minaretFR_MiddleBalconyTop, minaretFR_MiddleBalconyBottom, minaretFR_HigherBalconyTop, minaretFR_HigherBalconyBottom, minaretFR_SpikeBottom, minaretFR_Spike, minaretFR_SpikeCircle1, minaretFR_SpikeCircle2, minaretFR_SpikeTop, minaretFR_Moon;
            var minaretBR_Base, minaretBR_LowerCylinder, minaretBR_deco2Base, minaretBR_deco1Base, minaretBR_BaseLinkOcto, minaretBR_LowerBalconyBottom, minaretBR_LowerBalconyTop, minaretBR_MiddleCylinder, minaretBR_MiddleBalconyTop, minaretBR_MiddleBalconyBottom, minaretBR_HigherBalconyTop, minaretBR_HigherBalconyBottom, minaretBR_SpikeBottom, minaretBR_Spike, minaretBR_SpikeCircle1, minaretBR_SpikeCircle2, minaretBR_SpikeTop, minaretBR_Moon;
            var minaretBL_Base, minaretBL_LowerCylinder, minaretBL_deco2Base, minaretBL_deco1Base, minaretBL_BaseLinkOcto, minaretBL_LowerBalconyBottom, minaretBL_LowerBalconyTop, minaretBL_MiddleCylinder, minaretBL_MiddleBalconyTop, minaretBL_MiddleBalconyBottom, minaretBL_HigherBalconyTop, minaretBL_HigherBalconyBottom, minaretBL_SpikeBottom, minaretBL_Spike, minaretBL_SpikeCircle1, minaretBL_SpikeCircle2, minaretBL_SpikeTop, minaretBL_Moon;
            var minaret_Base, minaret_LowerCylinder, minaret_deco2Base, minaret_deco1Base, minaret_BaseLinkOcto, minaret_LowerBalconyBottom, minaret_LowerBalconyTop, minaret_MiddleCylinder, minaret_MiddleBalconyTop, minaret_MiddleBalconyBottom, minaret_HigherBalconyTop, minaret_HigherBalconyBottom, minaret_SpikeBottom, minaret_Spike, minaret_SpikeCircle1, minaret_SpikeCircle2, minaret_SpikeTop, minaret_Moon;
           
            //DÉCLARATION DES PETITS DÔMES FRONT
            var little_sphere_FLL, little_cylindre_FLL, little_octogone_FLL;
            var little_sphere_FLR, little_cylindre_FLR, little_octogone_FLR;
            var little_sphere_FRR, little_cylindre_FRR, little_octogone_FRR;
            var little_sphere_FRL, little_cylindre_FRL, little_octogone_FRL;

            //DÉCLARATION DES PETITS DÔMES BACK
            var little_sphere_BLL, little_cylindre_BLL, little_octogone_BLL;
            var little_sphere_BLR, little_cylindre_BLR, little_octogone_BLR;
            var little_sphere_BRR, little_cylindre_BRR, little_octogone_BRR;
            var little_sphere_BRL, little_cylindre_BRL, little_octogone_BRL;

            //DÉCLARATION DES PETITS DÔMES LEFT
            var little_sphere_L1, little_cylindre_L1, little_octogone_L1;
            var little_sphere_L2, little_cylindre_L2, little_octogone_L2;
            var little_sphere_L3, little_cylindre_L3, little_octogone_L3;
            var little_sphere_L4, little_cylindre_L4, little_octogone_L4;

            //DÉCLARATION DES PETITS DÔMES RIGHT
            var little_sphere_R1, little_cylindre_R1, little_octogone_R1;
            var little_sphere_R2, little_cylindre_R2, little_octogone_R2;
            var little_sphere_R3, little_cylindre_R3, little_octogone_R3;
            var little_sphere_R4, little_cylindre_R4, little_octogone_R4;

            //DÉCLARATION DES DÔMES PRINCIPAUX
            var main_sphere, main_cylindre, main_octogone;
            var bigLeft_sphere, bigLeft_cylindre, bigLeft_octogone;
            var bigRight_sphere, bigRight_cylindre, bigRight_octogone;
            var midBack_sphere, midBack_cylindre, midBack_octogone;
            var midFront_sphere, midFront_cylindre, midFront_octogone;

            //CRÉATION DE LA CAMÉRA SUPER DYNAMIQUE
            camera = new THREE.PerspectiveCamera( 70, window.innerWidth/window.innerHeight, 1, 1000000 );
            camera.position.set( 70000, 70000, 70000 );

			init(); //Pour créer la scène
			animate(); //Pour animer la scène (boucle qui tourne en permanence)
            
			function init() {

                //Création de l'espace 3D (scène) avec ses axes
                scene = new THREE.Scene();
                scene.background = new THREE.CubeTextureLoader()
                    .setPath( 'textures/cube/MilkyWay/' )
                    .load( [
                        'dark-s_px.jpg',
                        'dark-s_nx.jpg',
                        'dark-s_py.jpg',
                        'dark-s_ny.jpg',
                        'dark-s_pz.jpg',
                        'dark-s_nz.jpg'
                    ] ); //SKYBOX DU BACKGROUND

                ambient = new THREE.AmbientLight( 0xffffff, 0.1 );
				scene.add( ambient );

                spotLight = new THREE.SpotLight( 0xffffff, 2 );
				spotLight.position.set( 20000, 40000, 40000 );
				spotLight.angle = 1.05;
				spotLight.penumbra = 0.1;
				spotLight.decay = 1;
                spotLight.focus = 1;
				spotLight.distance = 70000;

				spotLight.castShadow = true;
				spotLight.shadow.mapSize.width = 512;
				spotLight.shadow.mapSize.height = 512;
				spotLight.shadow.camera.near = 1;
				spotLight.shadow.camera.far = 100000;
				spotLight.shadow.focus = 1;
				scene.add( spotLight );

				lightHelper = new THREE.SpotLightHelper( spotLight );
				scene.add( lightHelper );

                //Chargement des textures
				var texture = new THREE.TextureLoader().load( '../ressources/textures/grid.png' );

                var turretTexture = new THREE.TextureLoader().load( '../ressources/textures/square-outline.png' );
                
                var wallTexture = new THREE.TextureLoader().load( '../ressources/textures/square-outline.png' );

                var groundTexture = new THREE.TextureLoader().load( '../ressources/textures/brick_bump.jpg' );
                    groundTexture.wrapS = THREE.RepeatWrapping;
                    groundTexture.wrapT = THREE.RepeatWrapping;
                    groundTexture.repeat.set( 20, 20 );

                var sphereTexture = new THREE.TextureLoader().load( '../ressources/textures/square-outline.png' );
                    sphereTexture.wrapS = THREE.RepeatWrapping;
                    sphereTexture.wrapT = THREE.RepeatWrapping;
                    sphereTexture.repeat.set( 30, 30 );

                //var grassTexture = new THREE.TextureLoader().load( '../ressources/textures/terrain/grasslight-big.jpg');
                                                     
                //Création des matériaux
                var material = new THREE.MeshPhongMaterial( { map: texture, side: THREE.DoubleSide } );
                var turretMaterial = new THREE.MeshPhongMaterial( { map: turretTexture, side: THREE.DoubleSide } );
                var wallMaterial = new THREE.MeshPhongMaterial( { map: wallTexture, side: THREE.DoubleSide } );
                var groundMaterial = new THREE.MeshPhongMaterial( { map: groundTexture, side: THREE.DoubleSide } );
                var sphereMaterial = new THREE.MeshPhongMaterial( { map: sphereTexture, side: THREE.DoubleSide } );
                //var grass = new THREE.MeshBasicMaterial( { map:  grassTexture, side: THREE.DoubleSide} );

                //PLATEAU
                //var floor = new THREE.BoxBufferGeometry(90000, 2000, 90000);
                //mesh_floor = new THREE.Mesh( floor,  grass);
                //mesh_floor.receiveShadow = true;
                //mesh_floor.position.y = -mesh_floor.geometry.parameters.height/2 - 1000;
                //scene.add(mesh_floor);
                                                
                //DÉFINITION DU SOL
				var groundGeometry = new THREE.BoxBufferGeometry( 30000, 1000, 42000 ); //Type/Forme d'objet
				ground = new THREE.Mesh( groundGeometry, groundMaterial ); //Création de l'objet avec ses matériaux
                ground.position.y = -ground.geometry.parameters.height/2;
                ground.receiveShadow = true;
				scene.add( ground ); //Ajout de l'objet dans la scene


                //DÉFINITION DES MURS
                var longWallGeometry = new THREE.BoxBufferGeometry( 3000, 3000, 42000 );
                var largeWallGeometry = new THREE.BoxBufferGeometry( 30000, 3000, 3000 );

                    leftWall = new THREE.Mesh( longWallGeometry, wallMaterial );
                    leftWall.receiveShadow = true;
                    leftWall.castShadow = true;
                    scene.add( leftWall );
                    leftWall.position.x = -13500;
                    leftWall.position.y = leftWall.geometry.parameters.height/2;;

                    rightWall = new THREE.Mesh( longWallGeometry, wallMaterial );
                    rightWall.receiveShadow = true;
                    rightWall.castShadow = true;
                    scene.add( rightWall );
                    rightWall.position.x = 13500;
                    rightWall.position.y = rightWall.geometry.parameters.height/2;

                    frontWall = new THREE.Mesh( largeWallGeometry, wallMaterial );
                    frontWall.receiveShadow = true;
                    frontWall.castShadow = true;
                    scene.add( frontWall );
                    frontWall.position.x = 0;
                    frontWall.position.y = frontWall.geometry.parameters.height/2;
                    frontWall.position.z = ground.geometry.parameters.depth/2 - 1250;   

                    backWall = new THREE.Mesh( largeWallGeometry, wallMaterial );
                    backWall.receiveShadow = true;
                    backWall.castShadow = true;
                    scene.add( backWall );
                    backWall.position.x = 0;
                    backWall.position.y = backWall.geometry.parameters.height/2;
                    backWall.position.z = -ground.geometry.parameters.depth/2 + 1250;  


				//DÉFINITION DES TOURELLES DE LA BASE ARRIÈRE
                var turretGeometry = new THREE.BoxBufferGeometry( 3500, 4000, 3500 );
                    // TOURELLE GAUCHE
                    turretBackLeft = new THREE.Mesh( turretGeometry, turretMaterial );
                    turretBackLeft.receiveShadow = true;
                    turretBackLeft.castShadow = true;
                    scene.add( turretBackLeft );
                    turretBackLeft.position.x = -ground.geometry.parameters.width/2 + 1166.667;
                    turretBackLeft.position.z = -ground.geometry.parameters.depth/2 + 5000;    
                    turretBackLeft.position.y = turretBackLeft.geometry.parameters.height/2;

                    // TOURELLE DROITE
                    turretBackRight = new THREE.Mesh( turretGeometry, turretMaterial );
                    turretBackRight.receiveShadow = true;
                    turretBackRight.castShadow = true;
                    scene.add( turretBackRight );
                    turretBackRight.position.x = ground.geometry.parameters.width/2 - 1166.667;
                    turretBackRight.position.z = -ground.geometry.parameters.depth/2 + 5000;    
                    turretBackRight.position.y = turretBackRight.geometry.parameters.height/2;


                //DÉFINITION DES TOURELLES DE LA BASE AVANT
                var turretFrontGeometry = new THREE.BoxBufferGeometry( 5000, 5000, 5000 );
                var miniGeometryTurret = new THREE.BoxBufferGeometry( 1000, 6000, 1000 );
                    // TOURELLE DROITE
                    turretFrontRight = new THREE.Mesh( turretFrontGeometry, turretMaterial );
                    turretFrontRight.receiveShadow = true;
                    turretFrontRight.castShadow = true;
                    scene.add( turretFrontRight );
                    turretFrontRight.position.x = rightWall.position.x - 250;
                    turretFrontRight.position.z = frontWall.position.z;    
                    turretFrontRight.position.y = turretFrontRight.geometry.parameters.height/2;

                    miniTurretFrontLeft_frontRight = new THREE.Mesh( miniGeometryTurret, turretMaterial );
                    miniTurretFrontLeft_frontRight.receiveShadow = true;
                    miniTurretFrontLeft_frontRight.castShadow = true;
                    scene.add ( miniTurretFrontLeft_frontRight );
                    miniTurretFrontLeft_frontRight.position.y = miniTurretFrontLeft_frontRight.geometry.parameters.height/2;
                    miniTurretFrontLeft_frontRight.position.x = turretFrontRight.position.x - (turretFrontRight.geometry.parameters.width/2);
                    miniTurretFrontLeft_frontRight.position.z = turretFrontRight.position.z + (turretFrontRight.geometry.parameters.depth/2);

                    miniTurretFrontRight_frontRight = new THREE.Mesh( miniGeometryTurret, turretMaterial );
                    miniTurretFrontRight_frontRight.receiveShadow = true;
                    miniTurretFrontRight_frontRight.castShadow = true;
                    scene.add ( miniTurretFrontRight_frontRight );
                    miniTurretFrontRight_frontRight.position.y = miniTurretFrontRight_frontRight.geometry.parameters.height/2;
                    miniTurretFrontRight_frontRight.position.x = turretFrontRight.position.x + (turretFrontRight.geometry.parameters.width/2);
                    miniTurretFrontRight_frontRight.position.z = turretFrontRight.position.z + (turretFrontRight.geometry.parameters.depth/2); 

                    miniTurretBackRight_frontRight = new THREE.Mesh( miniGeometryTurret, turretMaterial );
                    miniTurretBackRight_frontRight.receiveShadow = true;
                    miniTurretBackRight_frontRight.castShadow = true;
                    scene.add ( miniTurretBackRight_frontRight );
                    miniTurretBackRight_frontRight.position.y = miniTurretBackRight_frontRight.geometry.parameters.height/2;
                    miniTurretBackRight_frontRight.position.x = turretFrontRight.position.x + (turretFrontRight.geometry.parameters.width/2);
                    miniTurretBackRight_frontRight.position.z = turretFrontRight.position.z - (turretFrontRight.geometry.parameters.depth/2);

                    // TOURELLE GAUCHE
                    turretFrontLeft = new THREE.Mesh( turretFrontGeometry, turretMaterial );
                    turretFrontLeft.receiveShadow = true;
                    turretFrontLeft.castShadow = true;
                    scene.add( turretFrontLeft );
                    turretFrontLeft.position.x = leftWall.position.x - 250;
                    turretFrontLeft.position.z = frontWall.position.z;    
                    turretFrontLeft.position.y = turretFrontLeft.geometry.parameters.height/2;

                    miniTurretFrontLeft_frontLeft = new THREE.Mesh( miniGeometryTurret, turretMaterial );
                    miniTurretFrontLeft_frontLeft.receiveShadow = true;
                    miniTurretFrontLeft_frontLeft.castShadow = true;
                    scene.add ( miniTurretFrontLeft_frontLeft );
                    miniTurretFrontLeft_frontLeft.position.y = miniTurretFrontLeft_frontLeft.geometry.parameters.height/2;
                    miniTurretFrontLeft_frontLeft.position.x = turretFrontLeft.position.x - (turretFrontLeft.geometry.parameters.width/2);
                    miniTurretFrontLeft_frontLeft.position.z = turretFrontLeft.position.z + (turretFrontLeft.geometry.parameters.depth/2);

                    miniTurretFrontRight_frontLeft = new THREE.Mesh( miniGeometryTurret, turretMaterial );
                    miniTurretFrontRight_frontLeft.receiveShadow = true;
                    miniTurretFrontRight_frontLeft.castShadow = true;
                    scene.add ( miniTurretFrontRight_frontLeft );
                    miniTurretFrontRight_frontLeft.position.y = miniTurretFrontRight_frontLeft.geometry.parameters.height/2;
                    miniTurretFrontRight_frontLeft.position.x = turretFrontLeft.position.x + (turretFrontLeft.geometry.parameters.width/2);
                    miniTurretFrontRight_frontLeft.position.z = turretFrontLeft.position.z + (turretFrontLeft.geometry.parameters.depth/2); 

                    miniTurretBackLeft_frontLeft = new THREE.Mesh( miniGeometryTurret, turretMaterial );
                    miniTurretBackLeft_frontLeft.receiveShadow = true;
                    miniTurretBackLeft_frontLeft.castShadow = true;
                    scene.add ( miniTurretBackLeft_frontLeft );
                    miniTurretBackLeft_frontLeft.position.y = miniTurretBackLeft_frontLeft.geometry.parameters.height/2;
                    miniTurretBackLeft_frontLeft.position.x = turretFrontLeft.position.x - (turretFrontLeft.geometry.parameters.width/2);
                    miniTurretBackLeft_frontLeft.position.z = turretFrontLeft.position.z - (turretFrontLeft.geometry.parameters.depth/2);
                     
                
                //DÉFINITION DES BÂTIMENTS
                var mainBuildGeometry = new THREE.BoxBufferGeometry( 27000, 6000, 7000 );       
                var mainBuildFrGeo = new THREE.BoxBufferGeometry( 27000, 3500, 3500 );
                var mainBuildLitFrGeo = new THREE.BoxBufferGeometry( 27000, 2000, 1750 );        
                var mainBuildMidGeo = new THREE.BoxBufferGeometry( 10000, 4500, 6250);


                    mainBuilding = new THREE.Mesh( mainBuildGeometry, turretMaterial );
                    mainBuilding.receiveShadow = true;
                    mainBuilding.castShadow = true;
                    scene.add( mainBuilding );
                    
                    mainBuilding.position.y = mainBuilding.geometry.parameters.height/2;
                    mainBuilding.receiveShadow = true;
                    mainBuilding.castShadow = true;
                    mainBuilding.position.z = -16000;

                    mainBuildingFront = new THREE.Mesh( mainBuildFrGeo, turretMaterial );
                    mainBuildingFront.receiveShadow = true;
                    mainBuildingFront.castShadow = true;
                    scene.add( mainBuildingFront );
                    mainBuildingFront.position.y = mainBuildingFront.geometry.parameters.height/2;
                    mainBuildingFront.position.z = mainBuilding.position.z + (mainBuilding.geometry.parameters.depth/2) + (mainBuildingFront.geometry.parameters.depth/2);

                    mainBuildingLittleFront = new THREE.Mesh( mainBuildLitFrGeo, wallMaterial );
                    mainBuildingLittleFront.receiveShadow = true;
                    mainBuildingLittleFront.castShadow = true;
                    scene.add( mainBuildingLittleFront );
                    mainBuildingLittleFront.position.y = mainBuildingLittleFront.geometry.parameters.height/2;
                    mainBuildingLittleFront.position.z = mainBuildingFront.position.z + (mainBuildingFront.geometry.parameters.depth/2) + (mainBuildingLittleFront.geometry.parameters.depth/2);
                    
                    mainBuildingMiddle = new THREE.Mesh( mainBuildMidGeo, turretMaterial );
                    mainBuildingMiddle.receiveShadow = true;
                    mainBuildingMiddle.castShadow = true;
                    scene.add( mainBuildingMiddle );
                    mainBuildingMiddle.position.y = mainBuildingMiddle.geometry.parameters.height/2;
                    mainBuildingMiddle.position.z = mainBuildingFront.position.z + (mainBuildingLittleFront.geometry.parameters.depth/2) + 500;

                    miniTurretMainBuilding_frontLeft = new THREE.Mesh( miniGeometryTurret, turretMaterial );
                    miniTurretMainBuilding_frontLeft.receiveShadow = true;
                    miniTurretMainBuilding_frontLeft.castShadow = true;
                    scene.add( miniTurretMainBuilding_frontLeft );
                    miniTurretMainBuilding_frontLeft.position.y = (miniTurretMainBuilding_frontLeft.geometry.parameters.height/2);
                    miniTurretMainBuilding_frontLeft.position.x = mainBuildingMiddle.position.x - (mainBuildingMiddle.geometry.parameters.width/2);
                    miniTurretMainBuilding_frontLeft.position.z = mainBuildingMiddle.position.z + (mainBuildingMiddle.geometry.parameters.depth/2);

                    miniTurretMainBuilding_frontRight = new THREE.Mesh( miniGeometryTurret, turretMaterial );
                    miniTurretMainBuilding_frontRight.receiveShadow = true;
                    miniTurretMainBuilding_frontRight.castShadow = true;
                    scene.add( miniTurretMainBuilding_frontRight );
                    miniTurretMainBuilding_frontRight.position.y = (miniTurretMainBuilding_frontRight.geometry.parameters.height/2);
                    miniTurretMainBuilding_frontRight.position.x = mainBuildingMiddle.position.x + (mainBuildingMiddle.geometry.parameters.width/2);
                    miniTurretMainBuilding_frontRight.position.z = mainBuildingMiddle.position.z + (mainBuildingMiddle.geometry.parameters.depth/2);

                    //DÉFINITION DE L'ENTRÉ
                    var gateGeometry = new THREE.BoxBufferGeometry( 10000, 4000, 5000 );
                    var miniGeometry = new THREE.BoxBufferGeometry( 1000, 5000, 1000 );

                    frontGateBig = new THREE.Mesh( turretFrontGeometry, turretMaterial );
                    scene.add( frontGateBig );
                    frontGateBig.position.z = frontWall.position.z + 500;    
                    frontGateBig.position.y = frontGateBig.geometry.parameters.height/2;

                    frontGateSmall = new THREE.Mesh ( gateGeometry, turretMaterial );
                    scene.add( frontGateSmall );
                    frontGateSmall.position.y = frontGateSmall.geometry.parameters.height/2;
                    frontGateSmall.position.z = frontGateBig.position.z - 500;

                    miniTurretFrontLeft = new THREE.Mesh ( miniGeometry, turretMaterial );
                    scene.add ( miniTurretFrontLeft );
                    miniTurretFrontLeft.position.y = miniTurretFrontLeft.geometry.parameters.height/2;
                    miniTurretFrontLeft.position.z = frontGateSmall.position.z + (frontGateSmall.geometry.parameters.depth/2);
                    miniTurretFrontLeft.position.x = frontGateSmall.position.x - (frontGateSmall.geometry.parameters.width/2);

                    miniTurretFrontRight = new THREE.Mesh ( miniGeometry, turretMaterial );
                    scene.add ( miniTurretFrontRight );
                    miniTurretFrontRight.position.y = miniTurretFrontRight.geometry.parameters.height/2;
                    miniTurretFrontRight.position.z = frontGateSmall.position.z + (frontGateSmall.geometry.parameters.depth/2);
                    miniTurretFrontRight.position.x = frontGateSmall.position.x + (frontGateSmall.geometry.parameters.width/2);

                    miniTurretBackLeft = new THREE.Mesh ( miniGeometry, turretMaterial );
                    scene.add ( miniTurretBackLeft );
                    miniTurretBackLeft.position.y = miniTurretBackLeft.geometry.parameters.height/2;
                    miniTurretBackLeft.position.z = frontGateSmall.position.z - (frontGateSmall.geometry.parameters.depth/2);
                    miniTurretBackLeft.position.x = frontGateSmall.position.x - (frontGateSmall.geometry.parameters.width/2);

                    miniTurretBackRight = new THREE.Mesh ( miniGeometry, turretMaterial );
                    scene.add ( miniTurretBackRight );
                    miniTurretBackRight.position.y = miniTurretBackRight.geometry.parameters.height/2;
                    miniTurretBackRight.position.z = frontGateSmall.position.z - (frontGateSmall.geometry.parameters.depth/2);
                    miniTurretBackRight.position.x = frontGateSmall.position.x + (frontGateSmall.geometry.parameters.width/2);

                addMinaret(turretFrontLeft);
                addMinaret(turretBackLeft, mainBuildingLittleFront);
                addMinaret(turretFrontRight);
                addMinaret(turretBackRight, mainBuildingLittleFront);
                
                //@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ DEBUT DOMES @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

                // DEFINITION PETITS DOMES
				var little_dome_sphere = new THREE.SphereBufferGeometry( 700, 32, 32);
				var little_dome_cylindre = new THREE.CylinderGeometry( 700, 700, 700, 32 );
				var little_dome_octogone = new THREE.CylinderGeometry( 800, 900, 500, 32 );

                    //FRONT LEFT
                    //FLL
                    little_octogone_FLL = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_FLL.position.y = frontWall.position.y + (frontWall.geometry.parameters.height/2) + (little_octogone_FLL.geometry.parameters.height/2);
                    little_octogone_FLL.position.x = frontWall.position.x - 9500;
                    little_octogone_FLL.position.z = frontWall.position.z;
                    scene.add(little_octogone_FLL);

                    little_cylindre_FLL = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_FLL.position.y = little_octogone_FLL.position.y + little_cylindre_FLL.geometry.parameters.height/2;
                    little_cylindre_FLL.position.x = little_octogone_FLL.position.x;
                    little_cylindre_FLL.position.z = little_octogone_FLL.position.z;
                    scene.add(little_cylindre_FLL);

                    little_sphere_FLL = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_FLL.position.y = little_cylindre_FLL.position.y + little_sphere_FLL.geometry.parameters.radius;
                    little_sphere_FLL.position.x = little_cylindre_FLL.position.x;
                    little_sphere_FLL.position.z = little_cylindre_FLL.position.z;
                    scene.add(little_sphere_FLL);

                    //FLR
                    little_octogone_FLR = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_FLR.position.y = frontWall.position.y + (frontWall.geometry.parameters.height/2) + (little_octogone_FLR.geometry.parameters.height/2);
                    little_octogone_FLR.position.x = frontWall.position.x - 6500;
                    little_octogone_FLR.position.z = frontWall.position.z;
                    scene.add(little_octogone_FLR);

                    little_cylindre_FLR = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_FLR.position.y = little_octogone_FLR.position.y + little_cylindre_FLR.geometry.parameters.height/2;
                    little_cylindre_FLR.position.x = little_octogone_FLR.position.x;
                    little_cylindre_FLR.position.z = little_octogone_FLR.position.z;
                    scene.add(little_cylindre_FLR);

                    little_sphere_FLR = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_FLR.position.y = little_cylindre_FLR.position.y + little_sphere_FLR.geometry.parameters.radius;
                    little_sphere_FLR.position.x = little_cylindre_FLR.position.x;
                    little_sphere_FLR.position.z = little_cylindre_FLR.position.z;
                    scene.add(little_sphere_FLR);

                    //FRONT RIGHT
                    //FRR
                    little_octogone_FRR = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_FRR.position.y = frontWall.position.y + (frontWall.geometry.parameters.height/2) + (little_octogone_FRR.geometry.parameters.height/2);
                    little_octogone_FRR.position.x = frontWall.position.x + 9500;
                    little_octogone_FRR.position.z = frontWall.position.z;
                    scene.add(little_octogone_FRR);

                    little_cylindre_FRR = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_FRR.position.y = little_octogone_FRR.position.y + little_cylindre_FRR.geometry.parameters.height/2;
                    little_cylindre_FRR.position.x = little_octogone_FRR.position.x;
                    little_cylindre_FRR.position.z = little_octogone_FRR.position.z;
                    scene.add(little_cylindre_FRR);

                    little_sphere_FRR = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_FRR.position.y = little_cylindre_FRR.position.y + little_sphere_FRR.geometry.parameters.radius;
                    little_sphere_FRR.position.x = little_cylindre_FRR.position.x;
                    little_sphere_FRR.position.z = little_cylindre_FRR.position.z;
                    scene.add(little_sphere_FRR);

                    //FRL
                    little_octogone_FRL = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_FRL.position.y = frontWall.position.y + (frontWall.geometry.parameters.height/2) + (little_octogone_FRL.geometry.parameters.height/2);
                    little_octogone_FRL.position.x = frontWall.position.x + 6500;
                    little_octogone_FRL.position.z = frontWall.position.z;
                    scene.add(little_octogone_FRL);

                    little_cylindre_FRL = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_FRL.position.y = little_octogone_FRL.position.y + little_cylindre_FRL.geometry.parameters.height/2;
                    little_cylindre_FRL.position.x = little_octogone_FRL.position.x;
                    little_cylindre_FRL.position.z = little_octogone_FRL.position.z;
                    scene.add(little_cylindre_FRL);

                    little_sphere_FRL = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_FRL.position.y = little_cylindre_FRL.position.y + little_sphere_FRL.geometry.parameters.radius;
                    little_sphere_FRL.position.x = little_cylindre_FRL.position.x;
                    little_sphere_FRL.position.z = little_cylindre_FRL.position.z;
                    scene.add(little_sphere_FRL);

                    //BACK LEFT
                    //BLL
                    little_octogone_BLL = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_BLL.position.y = mainBuildingLittleFront.position.y + (mainBuildingLittleFront.geometry.parameters.height/2) + (little_octogone_BLL.geometry.parameters.height/2);
                    little_octogone_BLL.position.x = mainBuildingLittleFront.position.x - 9500;
                    little_octogone_BLL.position.z = mainBuildingLittleFront.position.z;
                    scene.add(little_octogone_BLL);

                    little_cylindre_BLL = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_BLL.position.y = little_octogone_BLL.position.y + little_cylindre_BLL.geometry.parameters.height/2;
                    little_cylindre_BLL.position.x = little_octogone_BLL.position.x;
                    little_cylindre_BLL.position.z = little_octogone_BLL.position.z;
                    scene.add(little_cylindre_BLL);

                    little_sphere_BLL = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_BLL.position.y = little_cylindre_BLL.position.y + little_sphere_BLL.geometry.parameters.radius;
                    little_sphere_BLL.position.x = little_cylindre_BLL.position.x;
                    little_sphere_BLL.position.z = little_cylindre_BLL.position.z;
                    scene.add(little_sphere_BLL);

                    //BLR
                    little_octogone_BLR = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_BLR.position.y = mainBuildingLittleFront.position.y + (mainBuildingLittleFront.geometry.parameters.height/2) + (little_octogone_BLL.geometry.parameters.height/2);
                    little_octogone_BLR.position.x = mainBuildingLittleFront.position.x - 6500;
                    little_octogone_BLR.position.z = mainBuildingLittleFront.position.z;
                    scene.add(little_octogone_BLR);

                    little_cylindre_BLR = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_BLR.position.y = little_octogone_BLR.position.y + little_cylindre_BLR.geometry.parameters.height/2;
                    little_cylindre_BLR.position.x = little_octogone_BLR.position.x;
                    little_cylindre_BLR.position.z = little_octogone_BLR.position.z;
                    scene.add(little_cylindre_BLR);

                    little_sphere_BLR = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_BLR.position.y = little_cylindre_BLR.position.y + little_sphere_BLR.geometry.parameters.radius;
                    little_sphere_BLR.position.x = little_cylindre_BLR.position.x;
                    little_sphere_BLR.position.z = little_cylindre_BLR.position.z;
                    scene.add(little_sphere_BLR);

                    //BACK RIGHT
                    //BRR
                    little_octogone_BRR = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_BRR.position.y = mainBuildingLittleFront.position.y + (mainBuildingLittleFront.geometry.parameters.height/2) + (little_octogone_BLL.geometry.parameters.height/2);
                    little_octogone_BRR.position.x = mainBuildingLittleFront.position.x + 9500;
                    little_octogone_BRR.position.z = mainBuildingLittleFront.position.z;
                    scene.add(little_octogone_BRR);

                    little_cylindre_BRR = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_BRR.position.y = little_octogone_BRR.position.y + little_cylindre_BRR.geometry.parameters.height/2;
                    little_cylindre_BRR.position.x = little_octogone_BRR.position.x;
                    little_cylindre_BRR.position.z = little_octogone_BRR.position.z;
                    scene.add(little_cylindre_BRR);

                    little_sphere_BRR = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_BRR.position.y = little_cylindre_BRR.position.y + little_sphere_BRR.geometry.parameters.radius;
                    little_sphere_BRR.position.x = little_cylindre_BRR.position.x;
                    little_sphere_BRR.position.z = little_cylindre_BRR.position.z;
                    scene.add(little_sphere_BRR);

                    //BRL
                    little_octogone_BRL = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_BRL.position.y = mainBuildingLittleFront.position.y + (mainBuildingLittleFront.geometry.parameters.height/2) + (little_octogone_BLL.geometry.parameters.height/2);
                    little_octogone_BRL.position.x = mainBuildingLittleFront.position.x + 6500;
                    little_octogone_BRL.position.z = mainBuildingLittleFront.position.z;
                    scene.add(little_octogone_BRL);

                    little_cylindre_BRL = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_BRL.position.y = little_octogone_BRL.position.y + little_cylindre_BRL.geometry.parameters.height/2;
                    little_cylindre_BRL.position.x = little_octogone_BRL.position.x;
                    little_cylindre_BRL.position.z = little_octogone_BRL.position.z;
                    scene.add(little_cylindre_BRL);

                    little_sphere_BRL = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_BRL.position.y = little_cylindre_BRL.position.y + little_sphere_BRL.geometry.parameters.radius;
                    little_sphere_BRL.position.x = little_cylindre_BRL.position.x;
                    little_sphere_BRL.position.z = little_cylindre_BRL.position.z;
                    scene.add(little_sphere_BRL);

                    //LEFT
                    //L1
                    little_octogone_L1 = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_L1.position.y = leftWall.position.y + (leftWall.geometry.parameters.height/2) + (little_octogone_L1.geometry.parameters.height/2);
                    little_octogone_L1.position.x = leftWall.position.x;
                    little_octogone_L1.position.z = mainBuildingLittleFront.position.z;
                    scene.add(little_octogone_L1);

                    little_cylindre_L1 = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_L1.position.y = little_octogone_L1.position.y + little_cylindre_L1.geometry.parameters.height/2;
                    little_cylindre_L1.position.x = little_octogone_L1.position.x;
                    little_cylindre_L1.position.z = little_octogone_L1.position.z;
                    scene.add(little_cylindre_L1);

                    little_sphere_L1 = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_L1.position.y = little_cylindre_L1.position.y + little_sphere_L1.geometry.parameters.radius;
                    little_sphere_L1.position.x = little_cylindre_L1.position.x;
                    little_sphere_L1.position.z = little_cylindre_L1.position.z;
                    scene.add(little_sphere_L1);

                    //L2
                    little_octogone_L2 = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_L2.position.y = leftWall.position.y + (leftWall.geometry.parameters.height/2) + (little_octogone_L2.geometry.parameters.height/2);
                    little_octogone_L2.position.x = leftWall.position.x;
                    little_octogone_L2.position.z = mainBuildingLittleFront.position.z + 6500;
                    scene.add(little_octogone_L2);

                    little_cylindre_L2 = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_L2.position.y = little_octogone_L2.position.y + little_cylindre_L2.geometry.parameters.height/2;
                    little_cylindre_L2.position.x = little_octogone_L2.position.x;
                    little_cylindre_L2.position.z = little_octogone_L2.position.z;
                    scene.add(little_cylindre_L2);

                    little_sphere_L2 = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_L2.position.y = little_cylindre_L2.position.y + little_sphere_L2.geometry.parameters.radius;
                    little_sphere_L2.position.x = little_cylindre_L2.position.x;
                    little_sphere_L2.position.z = little_cylindre_L2.position.z;
                    scene.add(little_sphere_L2);

                    //L3
                    little_octogone_L3 = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_L3.position.y = leftWall.position.y + (leftWall.geometry.parameters.height/2) + (little_octogone_L3.geometry.parameters.height/2);
                    little_octogone_L3.position.x = leftWall.position.x;
                    little_octogone_L3.position.z = mainBuildingLittleFront.position.z + 13000;
                    scene.add(little_octogone_L3);

                    little_cylindre_L3 = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_L3.position.y = little_octogone_L3.position.y + little_cylindre_L3.geometry.parameters.height/2;
                    little_cylindre_L3.position.x = little_octogone_L3.position.x;
                    little_cylindre_L3.position.z = little_octogone_L3.position.z;
                    scene.add(little_cylindre_L3);

                    little_sphere_L3 = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_L3.position.y = little_cylindre_L3.position.y + little_sphere_L3.geometry.parameters.radius;
                    little_sphere_L3.position.x = little_cylindre_L3.position.x;
                    little_sphere_L3.position.z = little_cylindre_L3.position.z;
                    scene.add(little_sphere_L3);

                    //L4
                    little_octogone_L4 = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_L4.position.y = leftWall.position.y + (leftWall.geometry.parameters.height/2) + (little_octogone_L4.geometry.parameters.height/2);
                    little_octogone_L4.position.x = leftWall.position.x;
                    little_octogone_L4.position.z = mainBuildingLittleFront.position.z + 19500;
                    scene.add(little_octogone_L4);

                    little_cylindre_L4 = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_L4.position.y = little_octogone_L4.position.y + little_cylindre_L4.geometry.parameters.height/2;
                    little_cylindre_L4.position.x = little_octogone_L4.position.x;
                    little_cylindre_L4.position.z = little_octogone_L4.position.z;
                    scene.add(little_cylindre_L4);

                    little_sphere_L4 = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_L4.position.y = little_cylindre_L4.position.y + little_sphere_L4.geometry.parameters.radius;
                    little_sphere_L4.position.x = little_cylindre_L4.position.x;
                    little_sphere_L4.position.z = little_cylindre_L4.position.z;
                    scene.add(little_sphere_L4);

                    //RIGHT
                    //R1
                    little_octogone_R1 = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_R1.position.y = rightWall.position.y + (rightWall.geometry.parameters.height/2) + (little_octogone_R1.geometry.parameters.height/2);
                    little_octogone_R1.position.x = rightWall.position.x;
                    little_octogone_R1.position.z = mainBuildingLittleFront.position.z;
                    scene.add(little_octogone_R1);

                    little_cylindre_R1 = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_R1.position.y = little_octogone_R1.position.y + little_cylindre_R1.geometry.parameters.height/2;
                    little_cylindre_R1.position.x = little_octogone_R1.position.x;
                    little_cylindre_R1.position.z = little_octogone_R1.position.z;
                    scene.add(little_cylindre_R1);

                    little_sphere_R1 = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_R1.position.y = little_cylindre_R1.position.y + little_sphere_R1.geometry.parameters.radius;
                    little_sphere_R1.position.x = little_cylindre_R1.position.x;
                    little_sphere_R1.position.z = little_cylindre_R1.position.z;
                    scene.add(little_sphere_R1);

                    //R2
                    little_octogone_R2 = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_R2.position.y = rightWall.position.y + (rightWall.geometry.parameters.height/2) + (little_octogone_R1.geometry.parameters.height/2);
                    little_octogone_R2.position.x = rightWall.position.x;
                    little_octogone_R2.position.z = mainBuildingLittleFront.position.z + 6500;
                    scene.add(little_octogone_R2);

                    little_cylindre_R2 = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_R2.position.y = little_octogone_R2.position.y + little_cylindre_R2.geometry.parameters.height/2;
                    little_cylindre_R2.position.x = little_octogone_R2.position.x;
                    little_cylindre_R2.position.z = little_octogone_R2.position.z;
                    scene.add(little_cylindre_R2);

                    little_sphere_R2 = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_R2.position.y = little_cylindre_R2.position.y + little_sphere_R2.geometry.parameters.radius;
                    little_sphere_R2.position.x = little_cylindre_R2.position.x;
                    little_sphere_R2.position.z = little_cylindre_R2.position.z;
                    scene.add(little_sphere_R2);

                    //R3
                    little_octogone_R3 = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_R3.position.y = rightWall.position.y + (rightWall.geometry.parameters.height/2) + (little_octogone_R1.geometry.parameters.height/2);
                    little_octogone_R3.position.x = rightWall.position.x;
                    little_octogone_R3.position.z = mainBuildingLittleFront.position.z + 13000;
                    scene.add(little_octogone_R3);

                    little_cylindre_R3 = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_R3.position.y = little_octogone_R3.position.y + little_cylindre_R3.geometry.parameters.height/2;
                    little_cylindre_R3.position.x = little_octogone_R3.position.x;
                    little_cylindre_R3.position.z = little_octogone_R3.position.z;
                    scene.add(little_cylindre_R3);

                    little_sphere_R3 = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_R3.position.y = little_cylindre_R3.position.y + little_sphere_R3.geometry.parameters.radius;
                    little_sphere_R3.position.x = little_cylindre_R3.position.x;
                    little_sphere_R3.position.z = little_cylindre_R3.position.z;
                    scene.add(little_sphere_R3);

                    //R4
                    little_octogone_R4 = new THREE.Mesh( little_dome_octogone,material);
                    little_octogone_R4.position.y = rightWall.position.y + (rightWall.geometry.parameters.height/2) + (little_octogone_R1.geometry.parameters.height/2);
                    little_octogone_R4.position.x = rightWall.position.x;
                    little_octogone_R4.position.z = mainBuildingLittleFront.position.z + 19500;
                    scene.add(little_octogone_R4);

                    little_cylindre_R4 = new THREE.Mesh( little_dome_cylindre,material);
                    little_cylindre_R4.position.y = little_octogone_R4.position.y + little_cylindre_R4.geometry.parameters.height/2;
                    little_cylindre_R4.position.x = little_octogone_R4.position.x;
                    little_cylindre_R4.position.z = little_octogone_R4.position.z;
                    scene.add(little_cylindre_R4);

                    little_sphere_R4 = new THREE.Mesh( little_dome_sphere, sphereMaterial);
                    little_sphere_R4.position.y = little_cylindre_R4.position.y + little_sphere_R4.geometry.parameters.radius;
                    little_sphere_R4.position.x = little_cylindre_R4.position.x;
                    little_sphere_R4.position.z = little_cylindre_R4.position.z;
                    scene.add(little_sphere_R4);


                // MAIN DOME
                var main_dome_sphere = new THREE.SphereBufferGeometry( 3250, 32, 32);
                var main_dome_cylindre = new THREE.CylinderGeometry( 3250, 3250, 3250, 32 );
                var main_dome_octogone = new THREE.CylinderGeometry( 3350, 3500, 500, 32 );
                
                    main_octogone = new THREE.Mesh( main_dome_octogone,material);
                    main_octogone.position.y = mainBuilding.position.y + (mainBuilding.geometry.parameters.height/2) + (main_octogone.geometry.parameters.height/2);
                    main_octogone.position.x = mainBuilding.position.x;
                    main_octogone.position.z = mainBuilding.position.z;
                    scene.add(main_octogone);

                    main_cylindre = new THREE.Mesh( main_dome_cylindre,material);
                    main_cylindre.position.y = main_octogone.position.y + main_cylindre.geometry.parameters.height/2;
                    main_cylindre.position.x = main_octogone.position.x;
                    main_cylindre.position.z = main_octogone.position.z;
                    scene.add(main_cylindre);

                    main_sphere = new THREE.Mesh( main_dome_sphere, sphereMaterial);
                    main_sphere.position.y = main_cylindre.position.y + main_sphere.geometry.parameters.radius;
                    main_sphere.position.x = main_cylindre.position.x;
                    main_sphere.position.z = main_cylindre.position.z;
                    scene.add(main_sphere);

                // BIG DOMES
                var big_dome_sphere = new THREE.SphereBufferGeometry( 2000, 32, 32);
                var big_dome_cylindre = new THREE.CylinderGeometry( 2000, 2000, 3250, 32 );
                var big_dome_octogone = new THREE.CylinderGeometry( 2100, 2300, 500, 32 );
                    //LEFT
                    bigLeft_octogone = new THREE.Mesh( big_dome_octogone,material);
                    bigLeft_octogone.position.y = mainBuilding.position.y + (mainBuilding.geometry.parameters.height/2) + (bigLeft_octogone.geometry.parameters.height/2);
                    bigLeft_octogone.position.x = mainBuilding.position.x - 7000;
                    bigLeft_octogone.position.z = mainBuilding.position.z;
                    scene.add(bigLeft_octogone);

                    bigLeft_cylindre = new THREE.Mesh( big_dome_cylindre,material);
                    bigLeft_cylindre.position.y = bigLeft_octogone.position.y + bigLeft_cylindre.geometry.parameters.height/2;
                    bigLeft_cylindre.position.x = bigLeft_octogone.position.x;
                    bigLeft_cylindre.position.z = bigLeft_octogone.position.z;
                    scene.add(bigLeft_cylindre);

                    bigLeft_sphere = new THREE.Mesh( big_dome_sphere, sphereMaterial);
                    bigLeft_sphere.position.y = bigLeft_cylindre.position.y + bigLeft_sphere.geometry.parameters.radius;
                    bigLeft_sphere.position.x = bigLeft_cylindre.position.x;
                    bigLeft_sphere.position.z = bigLeft_cylindre.position.z;
                    scene.add(bigLeft_sphere);

                    //Right
                    bigRight_octogone = new THREE.Mesh( big_dome_octogone,material);
                    bigRight_octogone.position.y = mainBuilding.position.y + (mainBuilding.geometry.parameters.height/2) + (bigRight_octogone.geometry.parameters.height/2);
                    bigRight_octogone.position.x = mainBuilding.position.x + 7000;
                    bigRight_octogone.position.z = mainBuilding.position.z;
                    scene.add(bigRight_octogone);

                    bigRight_cylindre = new THREE.Mesh( big_dome_cylindre,material);
                    bigRight_cylindre.position.y = bigRight_octogone.position.y + bigRight_cylindre.geometry.parameters.height/2;
                    bigRight_cylindre.position.x = bigRight_octogone.position.x;
                    bigRight_cylindre.position.z = bigRight_octogone.position.z;
                    scene.add(bigRight_cylindre);

                    bigRight_sphere = new THREE.Mesh( big_dome_sphere, sphereMaterial);
                    bigRight_sphere.position.y = bigRight_cylindre.position.y + bigRight_sphere.geometry.parameters.radius;
                    bigRight_sphere.position.x = bigRight_cylindre.position.x;
                    bigRight_sphere.position.z = bigRight_cylindre.position.z;
                    scene.add(bigRight_sphere);

                // MIDDLE DOMES
                var mid_dome_sphere = new THREE.SphereBufferGeometry( 1200, 32, 32);
                var mid_dome_cylindre = new THREE.CylinderGeometry( 1200, 1200, 500, 32 );
                var mid_dome_octogone = new THREE.CylinderGeometry( 1400, 1500, 200, 32 );
                    //Back
                    midBack_octogone = new THREE.Mesh( mid_dome_octogone,material);
                    midBack_octogone.position.y = mainBuildingMiddle.position.y + (mainBuildingMiddle.geometry.parameters.height/2) + (midBack_octogone.geometry.parameters.height/2);
                    midBack_octogone.position.x = mainBuildingMiddle.position.x;
                    midBack_octogone.position.z = mainBuildingMiddle.position.z;
                    scene.add(midBack_octogone);

                    midBack_cylindre = new THREE.Mesh( mid_dome_cylindre,material);
                    midBack_cylindre.position.y = midBack_octogone.position.y + midBack_cylindre.geometry.parameters.height/2;
                    midBack_cylindre.position.x = midBack_octogone.position.x;
                    midBack_cylindre.position.z = midBack_octogone.position.z;
                    scene.add(midBack_cylindre);

                    midBack_sphere = new THREE.Mesh( mid_dome_sphere, sphereMaterial);
                    midBack_sphere.position.y = midBack_cylindre.position.y - midBack_cylindre.geometry.parameters.height/2 + midBack_sphere.geometry.parameters.radius;
                    midBack_sphere.position.x = midBack_cylindre.position.x;
                    midBack_sphere.position.z = midBack_cylindre.position.z;
                    scene.add(midBack_sphere);
                    
                    //Front
                    midFront_octogone = new THREE.Mesh( mid_dome_octogone,material);
                    midFront_octogone.position.y = frontGateBig.position.y + (frontGateBig.geometry.parameters.height/2) + (midFront_octogone.geometry.parameters.height/2);
                    midFront_octogone.position.x = frontGateBig.position.x;
                    midFront_octogone.position.z = frontGateBig.position.z;
                    scene.add(midFront_octogone);

                    midFront_cylindre = new THREE.Mesh( mid_dome_cylindre,material);
                    midFront_cylindre.position.y = midFront_octogone.position.y + midFront_cylindre.geometry.parameters.height/2;
                    midFront_cylindre.position.x = midFront_octogone.position.x;
                    midFront_cylindre.position.z = midFront_octogone.position.z;
                    scene.add(midFront_cylindre);

                    midFront_sphere = new THREE.Mesh( mid_dome_sphere, sphereMaterial);
                    midFront_sphere.position.y = midFront_cylindre.position.y - midFront_cylindre.geometry.parameters.height/2 + midFront_sphere.geometry.parameters.radius;
                    midFront_sphere.position.x = midFront_cylindre.position.x;
                    midFront_sphere.position.z = midFront_cylindre.position.z;
                    scene.add(midFront_sphere);

                //@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ FIN DOMES @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

                renderer = new THREE.WebGLRenderer( { antialias: true } ); //Moteur graphique (anti-aliasing: pour lisser le graphisme)
				renderer.setPixelRatio( window.devicePixelRatio ); //Respect du ration des pixels
				renderer.setSize( window.innerWidth, window.innerHeight ); //Taille du rendu
				document.body.appendChild( renderer.domElement ); //Attachement du rendu à l'html

                renderer.shadowMap.enabled = true; //Autoriser les ombres dans le moteur
                renderer.shadowMap.type = THREE.PCFSoftShadowMap; //Type d'ombre soft
                
                controls = new OrbitControls( camera, renderer.domElement );
                controls.update();

				window.addEventListener( 'resize', onWindowResize, false ); //Adaptation au changement de taille de la fenêtre avec appel de sa fonction ↩️

                //FONCTION MINARETS
                function addMinaret(turret, mainBuild){
                    var baseMinaretGeo = new THREE.BoxBufferGeometry( 200*(6000/700), 12000, 200*(6000/700) );
                    var decoMinaretGeo = new THREE.ConeBufferGeometry( 150*(6000/700), 200*(6000/700), 4 );
                    var linkGeo = new THREE.CylinderGeometry( 100*(6000/700), 140*(6000/700), 100*(6000/700), 4, 1 );
                    var geoLC = new THREE.CylinderBufferGeometry( 100*(6000/700), 100*(6000/700), 400*(6000/700), 8 );
                    var balconyGeoLB = new THREE.CylinderGeometry( 180*(6000/700), 100*(6000/700),50*(6000/700), 600, 1 );
                    var balconyGeoLT = new THREE.CylinderBufferGeometry( 180*(6000/700), 180*(6000/700), 30*(6000/700), 1000 );
                    var geoMC = new THREE.CylinderBufferGeometry( 50*(6000/700), 100*(6000/700), 400*(6000/700), 1000 );
                    var balconyGeoMB = new THREE.CylinderGeometry( 120*(6000/700), 80*(6000/700),50*(6000/700), 600, 1 );
                    var balconyGeoMT = new THREE.CylinderBufferGeometry( 120*(6000/700), 120*(6000/700), 30*(6000/700), 1000 );
                    var balconyGeoHB = new THREE.CylinderGeometry( 80*(6000/700), 50*(6000/700), 50*(6000/700), 600, 1 );
                    var balconyGeoHT = new THREE.CylinderBufferGeometry( 80*(6000/700), 80*(6000/700), 30*(6000/700), 1000 );
                    var spikeBottomGeo = new THREE.SphereBufferGeometry( 50*(6000/700), 32, 32 );
                    var spikeGeo = new THREE.CylinderBufferGeometry( 10*(6000/700), 30*(6000/700), 300*(6000/700), 1000 );
                    var spikeCircleGeo = new THREE.CylinderBufferGeometry( 30*(6000/700), 30*(6000/700), 10*(6000/700), 1000 );
                    var spikeTopGeo = new THREE.SphereBufferGeometry( 30*(6000/700), 30*(6000/700), 10 );
                    var moonGeo = new THREE.RingGeometry( 20*(6000/700), 30*(6000/700), 3000 );

                    //  BASE
                    minaret_Base = new THREE.Mesh( baseMinaretGeo, material ) ;//Création de l'objet avec ses matériaux
                    minaret_Base.position.y = minaret_Base.geometry.parameters.height/2;
                    
                    
                    if (turret.position.x > 0){
                        minaret_Base.position.x = turret.position.x - (turret.geometry.parameters.width/2);
                    } else {
                        minaret_Base.position.x = turret.position.x + (turret.geometry.parameters.width/2);
                    }

                    if(mainBuild != null){
                        console.log('wesh');
                        minaret_Base.position.z = mainBuild.position.z + minaret_Base.geometry.parameters.depth;
                    } else {
                        if (turret.position.z > 0){
                            minaret_Base.position.z = turret.position.z - (turret.geometry.parameters.depth/2);
                        } else {
                            minaret_Base.position.z = turret.position.z + (turret.geometry.parameters.depth/2);
                        }
                    }
                    
                    minaret_Base.castShadow = true;
                    scene.add(minaret_Base ); //Ajout de l'objet dans la scene

                    minaret_deco1Base = new THREE.Mesh( decoMinaretGeo, material );
                    minaret_deco1Base.position.y = minaret_Base.position.y + minaret_deco1Base.geometry.parameters.height/2;
                    minaret_deco1Base.position.z = minaret_Base.position.z;
                    minaret_deco1Base.position.x = minaret_Base.position.x;
                    
                    minaret_deco1Base.castShadow = true;
                    scene.add(minaret_deco1Base );
                    
                    minaret_deco2Base = new THREE.Mesh( decoMinaretGeo, material );
                    minaret_deco2Base.position.y = minaret_Base.position.y + minaret_deco2Base.geometry.parameters.height*2;
                    minaret_deco2Base.position.z = minaret_Base.position.z;
                    minaret_deco2Base.position.x = minaret_Base.position.x;
                    
                    minaret_deco2Base.castShadow = true;
                    scene.add(minaret_deco2Base );

                    minaret_BaseLinkOcto = new THREE.Mesh(linkGeo, material);
                    minaret_BaseLinkOcto.position.y = minaret_Base.position.y + minaret_Base.geometry.parameters.height/2 + minaret_BaseLinkOcto.geometry.parameters.height/2;;
                    minaret_BaseLinkOcto.rotation.y = Math.PI / 4;
                    minaret_BaseLinkOcto.position.z = minaret_Base.position.z;
                    minaret_BaseLinkOcto.position.x = minaret_Base.position.x;
                    
                    minaret_BaseLinkOcto.castShadow = true;
                    scene.add(minaret_BaseLinkOcto);
                
                    //  TRONC DU BAS
                    minaret_LowerCylinder = new THREE.Mesh( geoLC, material );
                    minaret_LowerCylinder.position.y = minaret_BaseLinkOcto.position.y + minaret_BaseLinkOcto.geometry.parameters.height/2 + minaret_LowerCylinder.geometry.parameters.height/2;
                    minaret_LowerCylinder.position.z = minaret_Base.position.z;
                    minaret_LowerCylinder.position.x = minaret_Base.position.x;                
                    
                    minaret_LowerCylinder.castShadow = true;
                    scene.add(minaret_LowerCylinder );

                    minaret_LowerBalconyBottom = new THREE.Mesh(balconyGeoLB, material);
                    minaret_LowerBalconyBottom.position.y = minaret_LowerCylinder.position.y + minaret_LowerCylinder.geometry.parameters.height/2 + minaret_LowerBalconyBottom.geometry.parameters.height/2;
                    minaret_LowerBalconyBottom.rotation.y = Math.PI / 4;
                    minaret_LowerBalconyBottom.position.z = minaret_Base.position.z;
                    minaret_LowerBalconyBottom.position.x = minaret_Base.position.x;
                    
                    minaret_LowerBalconyBottom.castShadow = true;
                    scene.add(minaret_LowerBalconyBottom);

                    minaret_LowerBalconyTop = new THREE.Mesh( balconyGeoLT, material );
                    minaret_LowerBalconyTop.position.y = minaret_LowerBalconyBottom.position.y + minaret_LowerBalconyBottom.geometry.parameters.height/2 + minaret_LowerBalconyTop.geometry.parameters.height/2;
                    minaret_LowerBalconyTop.position.z = minaret_Base.position.z;
                    minaret_LowerBalconyTop.position.x = minaret_Base.position.x;
                    
                    minaret_LowerBalconyTop.castShadow = true;
                    scene.add(minaret_LowerBalconyTop );
                    
                    //  TRONC DU HAUT
                    minaret_MiddleCylinder = new THREE.Mesh( geoMC, material );
                    minaret_MiddleCylinder.position.y = minaret_LowerBalconyTop.position.y + minaret_LowerBalconyTop.geometry.parameters.height/2 + minaret_MiddleCylinder.geometry.parameters.height/2;
                    minaret_MiddleCylinder.position.z = minaret_Base.position.z;
                    minaret_MiddleCylinder.position.x = minaret_Base.position.x;
                    
                    minaret_MiddleCylinder.castShadow = true;
                    scene.add(minaret_MiddleCylinder );

                    minaret_MiddleBalconyBottom = new THREE.Mesh(balconyGeoMB, material);
                    minaret_MiddleBalconyBottom.position.y = minaret_MiddleCylinder.position.y + minaret_MiddleCylinder.geometry.parameters.height/2 + minaret_MiddleBalconyBottom.geometry.parameters.height/2;
                    minaret_MiddleBalconyBottom.rotation.y = Math.PI / 4;
                    minaret_MiddleBalconyBottom.position.z = minaret_Base.position.z;
                    minaret_MiddleBalconyBottom.position.x = minaret_Base.position.x;
                    
                    minaret_MiddleBalconyBottom.castShadow = true;
                    scene.add(minaret_MiddleBalconyBottom);

                    minaret_MiddleBalconyTop = new THREE.Mesh( balconyGeoMT, material );
                    minaret_MiddleBalconyTop.position.y = minaret_MiddleBalconyBottom.position.y + minaret_MiddleBalconyBottom.geometry.parameters.height/2 + minaret_MiddleBalconyTop.geometry.parameters.height/2;
                    minaret_MiddleBalconyTop.position.z = minaret_Base.position.z;
                    minaret_MiddleBalconyTop.position.x = minaret_Base.position.x;
                    
                    minaret_MiddleBalconyTop.castShadow = true;
                    scene.add(minaret_MiddleBalconyTop );

                    minaret_HigherBalconyBottom = new THREE.Mesh(balconyGeoHB, material);
                    minaret_HigherBalconyBottom.position.y = minaret_MiddleBalconyTop.position.y + minaret_MiddleBalconyTop.geometry.parameters.height/2 + minaret_HigherBalconyBottom.geometry.parameters.height/2;
                    minaret_HigherBalconyBottom.rotation.y = Math.PI / 4;
                    minaret_HigherBalconyBottom.position.z = minaret_Base.position.z;
                    minaret_HigherBalconyBottom.position.x = minaret_Base.position.x;
                    
                    minaret_HigherBalconyBottom.castShadow = true;
                    scene.add(minaret_HigherBalconyBottom);

                    minaret_HigherBalconyTop = new THREE.Mesh( balconyGeoHT, material );
                    minaret_HigherBalconyTop.position.y = minaret_HigherBalconyBottom.position.y + minaret_HigherBalconyBottom.geometry.parameters.height/2 + minaret_HigherBalconyTop.geometry.parameters.height/2;
                    minaret_HigherBalconyTop.position.z = minaret_Base.position.z;
                    minaret_HigherBalconyTop.position.x = minaret_Base.position.x;
                    
                    minaret_HigherBalconyTop.castShadow = true;
                    scene.add(minaret_HigherBalconyTop );

                    //  POINTE DU MINARET
                    minaret_SpikeBottom = new THREE.Mesh( spikeBottomGeo, material );
                    minaret_SpikeBottom.position.y = minaret_HigherBalconyTop.position.y + minaret_HigherBalconyTop.geometry.parameters.height/2 + minaret_SpikeBottom.geometry.parameters.radius;
                    minaret_SpikeBottom.position.z = minaret_Base.position.z;
                    minaret_SpikeBottom.position.x = minaret_Base.position.x;
                    
                    minaret_SpikeBottom.castShadow = true;
                    scene.add(minaret_SpikeBottom );

                    minaret_Spike = new THREE.Mesh( spikeGeo, material );
                    minaret_Spike.position.y = minaret_SpikeBottom.position.y + minaret_SpikeBottom.geometry.parameters.radius + minaret_Spike.geometry.parameters.height/2;
                    minaret_Spike.position.z = minaret_Base.position.z;
                    minaret_Spike.position.x = minaret_Base.position.x;
                    
                    minaret_Spike.castShadow = true;
                    scene.add(minaret_Spike);

                    minaret_SpikeCircle1 = new THREE.Mesh( spikeCircleGeo, material );
                    minaret_SpikeCircle1.position.y = minaret_Spike.position.y + minaret_Spike.geometry.parameters.height/2 + minaret_SpikeCircle1.geometry.parameters.height/2;
                    minaret_SpikeCircle1.position.z = minaret_Base.position.z;
                    minaret_SpikeCircle1.position.x = minaret_Base.position.x;
                    
                    minaret_SpikeCircle1.castShadow = true;
                    scene.add(minaret_SpikeCircle1 );

                    minaret_SpikeCircle2 = new THREE.Mesh( spikeCircleGeo, material );
                    minaret_SpikeCircle2.position.y = minaret_SpikeCircle1.position.y + minaret_SpikeCircle1.geometry.parameters.height/2 + minaret_SpikeCircle2.geometry.parameters.height/2;
                    minaret_SpikeCircle2.position.z = minaret_Base.position.z;
                    minaret_SpikeCircle2.position.x = minaret_Base.position.x;
                    
                    minaret_SpikeCircle2.castShadow = true;
                    scene.add(minaret_SpikeCircle2 );

                    minaret_SpikeTop = new THREE.Mesh( spikeTopGeo, material );
                    minaret_SpikeTop.position.y = minaret_SpikeCircle2.position.y + minaret_SpikeCircle2.geometry.parameters.height/2 + minaret_SpikeTop.geometry.parameters.radius;
                    minaret_SpikeTop.position.z = minaret_Base.position.z;
                    minaret_SpikeTop.position.x = minaret_Base.position.x;
                    
                    minaret_SpikeTop.castShadow = true;
                    scene.add(minaret_SpikeTop );

                    minaret_Moon = new THREE.Mesh( moonGeo, material );
                    minaret_Moon.position.y = minaret_SpikeTop.position.y + minaret_SpikeTop.geometry.parameters.radius;
                    minaret_Moon.position.z = minaret_Base.position.z;
                    minaret_Moon.position.x = minaret_Base.position.x;
                    
                    minaret_Moon.castShadow = true;
                    scene.add(minaret_Moon );

                }

			}

			function onWindowResize() {
                //Adaptation au changement de taille de la fenêtre
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
                
				renderer.setSize( window.innerWidth, window.innerHeight ); //Taille du rendu

			}
            
            function animate() {

                requestAnimationFrame( animate );

                // required if controls.enableDamping or controls.autoRotate are set to true
                controls.update();
                
                
                renderer.render( scene, camera );

            }

            
		</script>
	</body>
</html>
